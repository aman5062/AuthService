<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Panel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, Helvetica, sans-serif;
        }

        body {
            background: #f4f6f9;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        nav {
            height: 60px;
            background: #0f292f;
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 40px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .logo {
            font-size: 20px;
            font-weight: bold;
            letter-spacing: 1px;
        }

        .linkshead {
            display: flex;
            gap: 30px;
            list-style: none;
        }

        .linkshead li a {
            text-decoration: none;
            color: #ffffff;
            font-size: 15px;
            padding: 8px 14px;
            border-radius: 6px;
            transition: 0.3s ease;
        }

        .linkshead li a:hover {
            background: #ffffff;
            color: #0f292f;
        }

        .content {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
        }

        .card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }

        h2 {
            margin-bottom: 10px;
            color: #0f292f;
        }
        table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
}

th, td {
    padding: 10px;
    text-align: left;
    border-bottom: 1px solid #ddd;
    font-size: 14px;
}

th {
    background-color: #0f292f;
    color: white;
}

tr:hover {
    background-color: #f1f1f1;
}
.btn-pagination{
    height: 30px;
    margin: 5px;
    background-color: lightblue;
    color: white;
}
.btn-pagination button{
    height: 30px;
    width: 50px;

}

    </style>
</head>

<body>

    <nav>
        <div class="logo">
            Admin Panel
        </div>

        <ul class="linkshead">
            <li><a href="/dashboard/config">Config</a></li>
            <li><a href="/dashboard/log">Logs</a></li>
            <li><a href="/dashboard/session">Sessions</a></li>
        </ul>
    </nav>

    <div class="content">
        <div class="card">
        <h2>Logs</h2>

        <div id="logsContainer">
            <p>Loading logs...</p>
        </div>
    </div>
    <div style="width: 100%; height: 30px;  border-radius: 10px; display: flex; justify-content: right;">
        <div class="btn-pagination"><button onclick="next()">prev</button></div>
        <div class="btn-pagination"><button onclick="prev()">next</button></div>
    </div>

    </div>

</body>
<script>
let currentPage = 1;
const limit = 7;

document.addEventListener("DOMContentLoaded", () => {
    loadLogs();
});

async function loadLogs() {
    const container = document.getElementById("logsContainer");

    try {
        const res = await fetch(`/api/admin/logs?page=${currentPage}&limit=${limit}`);
        const result = await res.json();

        if (!result.success || !result.data.logs.length) {
            container.innerHTML = "<p>No logs found.</p>";
            return;
        }

        const logs = result.data.logs;

        let table = '<table>' +
            '<thead>' +
                '<tr>' +
                    '<th>ID</th>' +
                    '<th>User</th>' +
                    '<th>Email</th>' +
                    '<th>Action</th>' +
                    '<th>Created At</th>' +
                '</tr>' +
            '</thead>' +
            '<tbody>';

        logs.forEach(function(log) {
            table +=
                '<tr>' +
                    '<td>' + log.id + '</td>' +
                    '<td>' + (log.user ? log.user.first_name : 'N/A') + '</td>' +
                    '<td>' + (log.user ? log.user.email : 'N/A') + '</td>' +
                    '<td>' + log.action + '</td>' +
                    '<td>' + new Date(log.createdAt).toLocaleString() + '</td>' +
                '</tr>';
        });

        table += '</tbody></table>';

        container.innerHTML = table;

    } catch (err) {
        container.innerHTML = "<p style='color:red;'>Failed to load logs.</p>";
        console.error(err);
    }
}

function next() {
    currentPage++;
    loadLogs();
}

function prev() {
    if (currentPage > 1) {
        currentPage--;
        loadLogs();
    }
}
</script>



</html>
